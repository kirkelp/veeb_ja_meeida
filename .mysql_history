SHOW TABLES;
SELECT *FROM film;
SHOW TABLES;
SELECT * FROM film; 
INSERT INTO film VALUES ("Don Juan Tallinnas","1971","65","Muusikafilm, komöödia","Tallinnfilm","Arvo Kruusement");
INSERT INTO film VALUES ("Hukkunud alpinisti hotell","1979","80","Detektiivfilm, Põnevusfilm, Ulmefilm","Tallinnfilm","Grigori Kromanov");
INSERT INTO film VALUES ("Kevade","1969","84","Komöödia, Draama","Tallinnfilm","Arvo Kruusement");
INSERT INTO film VALUES ("Viini postmark","1967","91","Komöödia","Tallinnfilm","Veljo Käsper");
INSERT INTO film VALUES ("Mehed ei nuta","1968","78","Komöödia","Eesti Telefilm","Sulev Nõmmik");
INSERT INTO film VALUES ("Noor pensionär","1972","80","Komöödia","Eesti Telefilm","Sulev Nõmmik");
INSERT INTO film VALUES ("Suvi","1976","81","Komöödia"," Tallinnfilm","Sulev Nõmmik");
SELECT * FROM film;
DELETE FROM film WHERE pealkiri = "Suvi";
SELECT * FROM film;
INSERT INTO film VALUES ("Suvi","1976","81","Komöödia"," Tallinnfilm","Sulev Nõmmik");
SELECT * FROM film;
UPDATE film SET pealkiri = "Siin me oleme!" WHERE aasta = "1978";
SELECT * FROM film;
SELECT aasta, zanr  FROM film;
INSERT INTO film VALUES ("1944","2015","100","Mängufilm","Taska Film","Elmo Nüganen");
INSERT INTO film VALUES ("Aaria","1997","15:33","Mängufilm","Allfilm","Ervin Õunapuu");
INSERT INTO film VALUES ("Aaria","1997","15","Mängufilm","Allfilm","Ervin Õunapuu");
SELECT * FROM film WHERE aasta = >"1970";
SELECT * FROM film WHERE tootja  = "Tallinnfilm";
SELECT * FROM film WHERE tootja  = "Tallinnfilm" ORDER BY kestus;
SELECT pealkiri, kestus FROM film WHERE tootja  = "Tallinnfilm" ORDER BY kestus;
SELECT * FROM film WHERE aasta <= "1971";
SELECT * FROM film WHERE aasta <= 1971;
ALTER DATABASE if20_kirkelp_3 CHARACTER SET = 'utf8' COLLATE = 'utf8_estonian_ci';
source Filmimaailm_create.sql;
SHOW TABLES;
LOAD DATA LOCAL INFILE 'faili-nimi' INTO TABLE tabelinimi FIELDS TERMINATED BY ','
;
LOAD DATA LOCAL INFILE 'faili-nimi' INTO TABLE tabelinimi FIELDS TERMINATED BY ',' LOAD DATA LOCAL INFILE 'faili-nimi' INTO TABLE tabelinimi FIELDS TERMINATED BY ',' LOAD DATA LOCAL INFILE 'faili-nimi' INTO TABLE tabelinimi FIELDS TERMINATED BY ',';
LOAD DATA LOCAL INFILE 'person.txt' INTO TABLE person  FIELDS TERMINATED BY  ',' ENCLOSED BY ;
LOAD DATA LOCAL INFILE 'person.txt' INTO TABLE person FIELDS TERMINATED BY ',' ENCLOSED BY '"';
LOAD DATA LOCAL INFILE 'movie.txt' INTO TABLE movie FIELDS TERMINATED BY ',' ENCLOSED BY '"';
LOAD DATA LOCAL INFILE 'person_in_movie.txt' INTO TABLE person_in_movie FIELDS TERMINATED BY ',' ENCLOSED BY '"';
LOAD DATA LOCAL INFILE 'position' INTO TABLE position FIELDS TERMINATED BY ',' ENCLOSED BY '"';
LOAD DATA LOCAL INFILE 'position.txt' INTO TABLE position FIELDS TERMINATED BY ',' ENCLOSED BY '"';
LOAD DATA LOCAL INFILE 'genre.txt' INTO TABLE genre FIELDS TERMINATED BY ',' ENCLOSED BY '"';
LOAD DATA LOCAL INFILE 'movie_genre.txt' INTO TABLE movie_genre FIELDS TERMINATED BY ',' ENCLOSED BY '"';
show tables;
show database Filmimaailm;
SHOW TABLES;
SHOW COLUMNS FROM movie_genre;
SHOW COLUMNS FROM person_in_movie;
SHOW TABLES;
SHOW DATABASE;
SHOW DATABASE FROM movie;
SHOW TABLES;
SHOW COLUMNS FROM movie;
LOAD DATA LOCAL INFILE 'person_in_movie.txt' INTO TABLE person_in_movie FIELDS TERMINATED BY ',' ENCLOSED BY '"';
SHOW TABLES;
LOAD DATA LOCAL INFILE 'person_in_movie.txt' INTO TABLE person_in_movie FIELDS TERMINATED BY ',' ENCLOSED BY '"';
LOAD DATA LOCAL INFILE 'person_in_movie' INTO TABLE person_in_movie FIELDS TERMINATED BY ','ENCLOSED BY '"';
SHOW TABLES;
SHOW COLUMNS FROM person_in_movie;
LOAD DATA LOCAL INFILE 'person_in_movie.txt' INTO TABLE person_in_movie FIELDS TERMINATED BY ','
ENCLOSED BY '"';
LOAD DATA LOCAL INFILE 'person_in_movie.txt' INTO TABLE person_in_movie FIELDS TERMINATED BY ',' ENCLOSED BY '"';
LOAD DATA LOCAL INFILE 'person_in_movie' INTO TABLE person_in_movie FIELDS TERMINATED BY ',' ENCLOSED BY '"';
SHOW COLUMNS FROM movie_genre;
SELECT * FROM movie_genre;
UPDATE movie_genre;
LOAD DATA LOCAL INFILE 'person_in_movie.txt' INTO TABLE person_in_movie FIELDS TERMINATED BY ',' ENCLOSED BY '"';
ls
cd
LOAD DATA LOCAL INFILE 'person_in_movie.txt' INTO TABLE person_in_movie FIELDS TERMINATED BY ',' ENCLOSED BY '"';
SELECT first_name, title FROM person JOIN movie;
SELECT first_name, last_name, role FROM person INNER  JOIN person_in_movie ON person.person_id = person_in_movie.person_id; 
SELECT first_name, last_name, role FROM person INNER  JOIN person_in_movie ON person.person_id = person_in_movie.person_id WHERE position_id =1; 
SELECT first_name, last_name, role FROM person INNER  JOIN person_in_movie ON person.person_id = person_in_movie.person_id WHERE position_id =2; 
SELECT first_name, last_name, role, title FROM person INNER  JOIN person_in_movie ON person.person_id = person_in_movie.person_id JOIN movie ON movie.movie_id = person_in_movie.movie_id;
SELECT first_name, last_name, role, title, duration  FROM movie, person_in_movie ORDER BY title, role WHERE position = 2, duration;  
SELECT first_name, last_name, role, title, duration  FROM person INNER  JOIN person_in_movie ON person.person_id = person_in_movie.person_id WHERE position = 2, JOIN movie ON movie.movie_id = person_in_movie.movie_id ORDER BY title, role, duration
;
SELECT first_name, last_name, role, title, duration  FROM person INNER  JOIN person_in_movie ON person.person_id = person_in_movie.person_id JOIN movie ON movie.movie_id = person_in_movie.movie_id ORDER BY title, role, duration WHERE role = 2 and movie.duration >120;
clear
SHOW COLUMNS FROM MOVIE;
SHOW COLUMNS FROM movie;
SELECT title, production_year, movie_genre FROM movie JOIN movie ON movie_id = movie_genre.movie_id;
SHOW COLUMNS FROM movie_genre;
SELECT title, production_year, movie_genre FROM movie JOIN movie_genre ON movie_genre. movie_id = movie.movie_id;
SELECT title, production_year, genre FROM movie JOIN movie_genre ON movie.movie_id = movie_genre.movie_id;
SELECT title, production_year, genre_name  FROM genre JOIN movie_genre ON genre.genre_id = movie_genre.genre_id JOIN movie ON movie.movie_id = movie_genre.movie_id ;
SELECT title,  first_name, last_name, role, duration  FROM person INNER  JOIN person_in_movie ON person.person_id = person_in_movie.person_id JOIN movie ON movie.movie_id = person_in_movie.movie_id;
INSERT INTO person VALUES (NULL,'Priit','Võigemast','1980-04-18');
INSERT INTO person VALUES (NULL,'Maiken','Pius','1985-04-17');
INSERT INTO person VALUES (NULL,'Priit','Pius','1989-02-04');
INSERT INTO person VALUES (NULL,'Märt','Pius','1989-02-04');
INSERT INTO person VALUES (NULL,'Saara','Pius','1990-09-20');
SELECT MAX(production_year) FROM movie;
SELECT MIN(production_year) FROM movie;
SELECT title,  MIN(production_year) FROM movie;
SELECT title,  MAX(production_year) FROM movie;
SELECT title, production_year FROM movie
 WHERE production_year = (SELECT MAX(production_year) FROM movie);
SELECT title, production_year FROM movie  WHERE production_year = (SELECT MAX(production_year) FROM movie);
SELECT title, production_year FROM movie WHERE production_year = (SELECT MAX(production_year)FROM movie);
SELECT title, production_year FROM movie WHERE production_year = (SELECT MIN(production_year)FROM movie);
SELECT person, birth_year FROM person WHERE birth_year > (SELECT MIN(production_year) FROM movie);
SELECT first_name, last_name, birth_year FROM person WHERE birth_year > (SELECT MIN(production_year) FROM movie);
SELECT first_name, last_name, YEAR(birth_date) FROM person WHERE YEAR(birth_date) > (SELECT MIN(production_year) FROM movie);
SELECT first_name, last_name, YEAR(birth_date) FROM person WHERE YEAR(birth_date) < (SELECT MIN(production_year) FROM movie);
SELECT first_name, last_name, YEAR(birth_date) FROM person WHERE YEAR(birth_date) > (SELECT MIN(production_year) FROM movie);
SELECT first_name, last_name, birth_date FROM person JOIN person_in_movie ON person.person_id = person_in_movie.person_id WHERE position_id = 1 AND  YEAR(birth_date) < (SELECT MIN(production_year) FROM movie);
SELECT first_name, last_name, birth_date FROM person JOIN person_in_movie ON person.person_id = person_in_movie.person_id WHERE position_id = 1 AND  YEAR(birth_date) > (SELECT MIN(production_year) FROM movie);
SELECT COUNT(*) FROM person_in_movie;
SELECT COUNT(*) FROM person;
SELECT COUNT(*) FROM person_in_movie GROUP BY person_id;
SELECT COUNT(*) FROM person_in_movie WHERE person_id=1;
SELECT first_name, last_name, (SELECT COUNT(*) FROM person_in_movie WHERE person.person_id = person_in_movie.person_id) AS movies FROM person;
